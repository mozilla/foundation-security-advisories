announced: September 14, 2006
fixed_in: Network Security Service (NSS) 3.11.3
          Firefox 1.5.0.7
          Thunderbird 1.5.0.7
          SeaMonkey 1.0.5
impact: Critical
mfsa_id: 2006-60
products: Firefox, Thunderbird, SeaMonkey
reporter: Philip Mackenzie, Marius Schilder
title: RSA Signature Forgery

<h3>Description</h3>

<p>Philip Mackenzie and Marius Schilder of Google informed us of Daniel Bleichenbacher's
recent presentation of a common implementation error in RSA signature verification,
a failure to account for extra data in the signature. For signatures with a small
exponent such as 3 it is possible for an attacker to calculate a value for this extra data to make an altered message appear to be correctly signed, allowing the signature to be forged.
Mozilla's Network Security Services (NSS) library was vulnerable to this flaw.</p>

<p>Because the set of root Certificate Authorities that ship with Mozilla clients
contain some with an exponent of 3 it was possible to make up certificates,
such as SSL/TLS and email certificates, that were not detected as invalid.
This raised the possibility of the sort of Man-in-the-Middle attacks
SSL/TLS was invented to prevent.</p>

<p>We thank Philip Mackenzie and Marius Schilder for bringing
this result to our attention and working with us to ensure the NSS library was
safe from variations on this basic attack.</p>

<h3>Workaround</h3>

<p>None, upgrade to a fixed version.</p>

<h3>References</h3>

<ul>
<li><a class="ex-ref" href="http://www.imc.org/ietf-openpgp/mail-archive/msg14307.html">
http://www.imc.org/ietf-openpgp/mail-archive/msg14307.html</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=350640">
https://bugzilla.mozilla.org/show_bug.cgi?id=350640</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=351079">
https://bugzilla.mozilla.org/show_bug.cgi?id=351079</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=351848">
https://bugzilla.mozilla.org/show_bug.cgi?id=351848</a></li>
<li><a class="ex-ref" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4340">
CVE-2006-4340</a></li>
<li><a class="ex-ref" href="http://www.kb.cert.org/vuls/id/845620">US-CERT VU#845620</a><br/>
Related to <a class="ex-ref" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4339">
CVE-2006-4339</a></li>
</ul>



