---
announced: April 21, 2009
fixed_in:
- Firefox 3.0.9
impact: High
reporter: moz_bug_r_a4
title: Same-origin violations in XMLHttpRequest and XPCNativeWrapper.toString
---

<h3>Description</h3>

<p>Mozilla security researcher <strong>moz_bug_r_a4</strong> reported
that it is possible to create a document whose URI does not match the
document's principal using <code>XMLHttpRequest</code>.  This type of
mismatch leads to incorrect results in principal-based security
checks.  An attacker could use this vulnerability to execute arbitrary
JavaScript within the context of another site.</p>

<p>moz_bug_r_a4 separately reported
that <code>XPCNativeWrapper.toString</code>'s
<code>__proto__</code> comes from the wrong scope which results in
calls to that function being executed in the wrong context in certain
circumstances.  An attacker could use this vulnerability to run
arbitrary code within the context of a different site.  Alternatively,
if chrome were to call <code>content.toString.call()</code>, then
attacker-defined functions could be run with chrome privileges.</p>

<p class="note">Thunderbird shares the browser engine with Firefox and
could be vulnerable if JavaScript were to be enabled in mail. This is
not the default setting and we strongly discourage users from running
JavaScript in mail.</p>

<h3>References</h3>

<ul>
  <li><a href="https://bugzilla.mozilla.org/buglist.cgi?bug_id=482206,478433">Same-origin violations</a></li>
  <li><a class="ex-ref" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1309">CVE-2009-1309</a></li>
</ul>



